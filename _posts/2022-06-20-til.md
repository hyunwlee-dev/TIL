---
layout: post
title: "ps BFS simulation"
author: "hyunwlee"
---

# BOJ 17144 미세먼지 안녕!

```
const dx = [0, 0, -1, 1];
const dy = [-1, 1, 0, 0];
function solution() {
    const [r, c, t] = input.shift().split(' ').map(e=>+e);
    const airFilter = [];
    let map = Array(r).fill(0).map(_=>Array(c).fill(0));
    for (let i = 0; i < r; ++i) {
        map[i] = input[i].split(' ').map(e => +e);
        for (let j = 0; j < c; ++j) {
            if (map[i][j] === -1) airFilter.push(i);
        }
    }
    let cnt = -1;
    while (++cnt < t) {
        const dist = Array(r).fill(0).map(_=>Array(c).fill(0));
        for (let i = 0; i < r; ++i) {
            for (let j = 0; j < c; ++j) {
                if (map[i][j] > 0) {
                    let cnt = 0;
                    for (let k = 0; k < 4; ++k) {
                        const nX = i + dx[k];
                        const nY = j + dy[k];
                        if (nX < 0 || nX >= r || nY < 0 || nY >= c) continue;
                        if (map[nX][nY] === -1) continue;
                        dist[nX][nY] += Math.floor(map[i][j] / 5);
                        ++cnt;
                    }
                    dist[i][j] += map[i][j] - Math.floor(map[i][j] / 5) * cnt;
                }
            }
        }
        map = dist;
        map[airFilter[0]][0] = -1;
        map[airFilter[1]][0] = -1;
        for (let i = airFilter[0] - 1; i >= 1; --i) {
            map[i][0] = dist[i - 1][0];
        }
        for (let j = 0; j < c - 1; ++j) {
            map[0][j] = dist[0][j + 1];
        }
        for (let i = 0; i < airFilter[0]; ++i) {
            map[i][c - 1] = dist[i + 1][c - 1];
        }
        for (let j = c - 1; j > 1; --j) {
            map[airFilter[0]][j] = dist[airFilter[0]][j - 1];
        }
        map[airFilter[0]][1] = 0;
        for (let i = airFilter[1] + 1; i < r - 1; i++)
            map[i][0] = dist[i + 1][0];
        for (let j = 0; j < c - 1; ++j) {
            map[r - 1][j] = dist[r - 1][j + 1];
        }
        for (let i = r - 1; i > airFilter[1]; --i) {
            map[i][c - 1] = dist[i - 1][c - 1];
        }
        for (let j = c - 1; j > 1; --j) {
            map[airFilter[1]][j] = dist[airFilter[1]][j - 1];
        }
        map[airFilter[1]][1] = 0;
        // let s = '\n';
        // for (let i = 0; i < r; ++i) {
        //     for (let j = 0; j < c; ++j) {
        //         s += map[i][j] + ' ';
        //     }
        //     s += '\n';
        // }
        // console.log(s);
    }
    let ans = 0;
    for (let i = 0; i < r; ++i) {
        for (let j = 0; j < c; ++j) {
            if (map[i][j] === -1) continue;
            ans += map[i][j];
        }
    }
    console.log(ans);
}

const BFS = (queue, dist, airFilter, map, r, c) => {
    while (!queue.isEmpty()) {
        const now = queue.poll();
        let cnt = 0;
        for (let i = 0; i < 4; ++i) {
            const nX = now.x + dx[i];
            const nY = now.y + dy[i];
            if (nX < 0 || nX >= r || nY < 0 || nY >= c) continue;
            if (map[nX][nY] === -1) continue;
            dist[nX][nY] += Math.floor(map[now.x][now.y] / 5);
            console.log(map[nX][nY]);
            ++cnt;
        }
        dist[now.x][now.y] += map[now.x][now.y] - Math.floor(map[now.x][now.y] / 5) * cnt;
    }
}
```
